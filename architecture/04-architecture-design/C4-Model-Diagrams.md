# C4 Model Diagrams

## ğŸ“‹ PropÃ³sito

Documenta la arquitectura usando el **C4 Model** (Context, Containers, Components, Code) para diferentes niveles de abstracciÃ³n.

## ğŸ¯ C4 Model Overview

El C4 Model define 4 niveles de diagramas:

1. **Level 1: System Context** - Big picture (sistema + usuarios + sistemas externos)
2. **Level 2: Container** - Aplicaciones y data stores que componen el sistema
3. **Level 3: Component** - Componentes dentro de un container
4. **Level 4: Code** - Clases/cÃ³digo (opcional, raramente necesario)

---

## ğŸ“Š Level 1: System Context Diagram

**Audience**: Todos (stakeholders tÃ©cnicos y no-tÃ©cnicos)

**Purpose**: Â¿QuÃ© hace el sistema? Â¿QuiÃ©n lo usa? Â¿Con quÃ© se integra?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    E-Commerce System                        â”‚
â”‚                                                             â”‚
â”‚  Platform de e-commerce que permite a usuarios comprar     â”‚
â”‚  productos online con pagos seguros y tracking de envÃ­os   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                    â”‚                    â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚ Customer â”‚        â”‚  Seller   â”‚       â”‚   Admin    â”‚
    â”‚ (Person) â”‚        â”‚ (Person)  â”‚       â”‚  (Person)  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚                    â”‚
         â”‚  Browse/Buy        â”‚  Manage Products   â”‚  Monitor
         â”‚                    â”‚                    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  E-Commerce System â”‚
                    â”‚                    â”‚
                    â”‚  [Web Application] â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                    â”‚                    â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Stripe    â”‚    â”‚   SendGrid    â”‚   â”‚  FedEx API   â”‚
    â”‚  (Payment)  â”‚    â”‚    (Email)    â”‚   â”‚  (Shipping)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Description**:

- **Customers**: Browse products, create orders, track shipments
- **Sellers**: Manage product catalog, view orders, update inventory
- **Admins**: Monitor system health, manage users, view analytics
- **Stripe**: Process credit card payments
- **SendGrid**: Send transactional emails (order confirmations, etc.)
- **FedEx API**: Get shipping rates, create labels, track packages

---

## ğŸ“¦ Level 2: Container Diagram

**Audience**: Technical team (developers, architects)

**Purpose**: Â¿QuÃ© aplicaciones/servicios componen el sistema?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        E-Commerce System                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Web App    â”‚                 â”‚     API Gateway         â”‚    â”‚
â”‚  â”‚  [React SPA]â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  [Kong / Node.js]       â”‚    â”‚
â”‚  â”‚             â”‚  HTTPS/JSON     â”‚  - JWT validation       â”‚    â”‚
â”‚  â”‚  Port: 3000 â”‚                 â”‚  - Rate limiting        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚  - Routing              â”‚    â”‚
â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                              â”‚                  â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚       â”‚         â”‚         â”‚         â”‚        â”‚        â”‚      â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  IAM   â”‚ â”‚Catalogâ”‚ â”‚ Order â”‚ â”‚Paymentâ”‚ â”‚Inventâ”‚ â”‚Customerâ”‚â”‚  â”‚
â”‚  â”‚Service â”‚ â”‚Serviceâ”‚ â”‚Serviceâ”‚ â”‚Serviceâ”‚ â”‚ory   â”‚ â”‚Serviceâ”‚â”‚  â”‚
â”‚  â”‚        â”‚ â”‚       â”‚ â”‚       â”‚ â”‚       â”‚ â”‚      â”‚ â”‚       â”‚â”‚  â”‚
â”‚  â”‚Node.js â”‚ â”‚Node.jsâ”‚ â”‚Node.jsâ”‚ â”‚Node.jsâ”‚ â”‚Node  â”‚ â”‚Node.jsâ”‚â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”˜â”‚  â”‚
â”‚       â”‚         â”‚         â”‚         â”‚        â”‚         â”‚    â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”â”‚  â”‚
â”‚  â”‚PostgreSQLâ”‚ â”‚MongoDB â”‚ â”‚PostgreSQLâ”‚ â”‚PostgreSQLâ”‚ â”‚PostgreSQLâ”‚â”‚
â”‚  â”‚(Users)   â”‚ â”‚(Products)â”‚(Orders)  â”‚ â”‚(Payments)â”‚ â”‚(Customers)â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               Message Queue (RabbitMQ)                    â”‚  â”‚
â”‚  â”‚  - order.created, payment.completed, inventory.low       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            Cache / Session Store (Redis)                  â”‚  â”‚
â”‚  â”‚  - Product cache, User sessions, Rate limiting counters  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

External Systems:
â”œâ”€ Stripe API (HTTPS)
â”œâ”€ SendGrid API (HTTPS)
â””â”€ FedEx API (HTTPS)
```

**Containers**:

| Container                | Technology         | Purpose                                        | Port  |
| ------------------------ | ------------------ | ---------------------------------------------- | ----- |
| **Web App**              | React + TypeScript | Single-page application para usuarios          | 3000  |
| **API Gateway**          | Kong               | Entry point, routing, authentication           | 8000  |
| **IAM Service**          | Node.js + Express  | Authentication, authorization, user management | 3001  |
| **Catalog Service**      | Node.js + Express  | Product catalog, categories, search            | 3002  |
| **Order Service**        | Node.js + Express  | Order creation, order management               | 3003  |
| **Payment Service**      | Node.js + Express  | Payment processing via Stripe                  | 3004  |
| **Inventory Service**    | Node.js + Express  | Stock management, reservations                 | 3005  |
| **Customer Service**     | Node.js + Express  | Customer profiles, addresses                   | 3006  |
| **Notification Service** | Node.js + Express  | Email notifications via SendGrid               | 3007  |
| **Shipping Service**     | Node.js + Express  | Shipping rates, tracking                       | 3008  |
| **PostgreSQL**           | PostgreSQL 15      | Relational data (users, orders, payments)      | 5432  |
| **MongoDB**              | MongoDB 7          | Document store (product catalog)               | 27017 |
| **RabbitMQ**             | RabbitMQ 3.12      | Message broker for async events                | 5672  |
| **Redis**                | Redis 7            | Cache + session store                          | 6379  |

---

## ğŸ”§ Level 3: Component Diagram (Order Service)

**Audience**: Developers working on this service

**Purpose**: Â¿QuÃ© componentes componen este container?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Order Service                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚         REST Controllers (Express)               â”‚     â”‚
â”‚  â”‚  - POST /orders (Create order)                   â”‚     â”‚
â”‚  â”‚  - GET /orders/:id (Get order)                   â”‚     â”‚
â”‚  â”‚  - PATCH /orders/:id/cancel (Cancel order)       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                   â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚         Application Services (Use Cases)         â”‚     â”‚
â”‚  â”‚  - CreateOrderUseCase                            â”‚     â”‚
â”‚  â”‚  - GetOrderUseCase                               â”‚     â”‚
â”‚  â”‚  - CancelOrderUseCase                            â”‚     â”‚
â”‚  â”‚  - ProcessPaymentUseCase                         â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                   â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚         Domain Layer (Business Logic)            â”‚     â”‚
â”‚  â”‚                                                  â”‚     â”‚
â”‚  â”‚  Entities:                                       â”‚     â”‚
â”‚  â”‚  - Order (Aggregate Root)                        â”‚     â”‚
â”‚  â”‚  - OrderItem (Entity)                            â”‚     â”‚
â”‚  â”‚  - Money (Value Object)                          â”‚     â”‚
â”‚  â”‚                                                  â”‚     â”‚
â”‚  â”‚  Domain Services:                                â”‚     â”‚
â”‚  â”‚  - OrderPricingService                           â”‚     â”‚
â”‚  â”‚  - OrderValidationService                        â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                   â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚      Infrastructure Layer (Technical)            â”‚     â”‚
â”‚  â”‚                                                  â”‚     â”‚
â”‚  â”‚  Repositories:                                   â”‚     â”‚
â”‚  â”‚  - OrderRepository (Prisma)                      â”‚     â”‚
â”‚  â”‚                                                  â”‚     â”‚
â”‚  â”‚  External Clients:                               â”‚     â”‚
â”‚  â”‚  - PaymentServiceClient (HTTP)                   â”‚     â”‚
â”‚  â”‚  - InventoryServiceClient (HTTP)                 â”‚     â”‚
â”‚  â”‚  - EventBus (RabbitMQ)                           â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Components Explanation**:

### REST Controllers

- Handle HTTP requests
- Validate input (DTOs)
- Call use cases
- Return HTTP responses

### Application Services (Use Cases)

- Orchestrate business operations
- Transaction boundaries
- Call domain services
- Publish events

### Domain Layer

- **Entities**: Objects with identity (Order, OrderItem)
- **Value Objects**: Immutable objects (Money, Address)
- **Domain Services**: Business logic that doesn't fit in entities
- **Aggregates**: Consistency boundaries (Order is root, contains OrderItems)

### Infrastructure Layer

- **Repositories**: Data access (SQL queries via Prisma)
- **External Clients**: HTTP clients para otros services
- **EventBus**: Publish/subscribe events

---

## ğŸ”€ Sequence Diagram: Create Order

**Flow**:

```
Customer    API Gateway   Order Service   Payment Service   Inventory   RabbitMQ
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚â”€ POST /orders â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚â”€â”€â”€â”€ Route â”€â”€â–¶â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚â”€â”€ Reserve â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚           â”‚
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚â—€â”€â”€ OK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚           â”‚
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚â”€â”€ Charge â”€â”€â”€â”€â”€â–¶â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚â—€â”€â”€ Payment OK â”€â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚â”€â”€ Save Order â”€â”€â”              â”‚           â”‚
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚           â”‚
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚â”€â”€ Publish: order.created â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚â—€â”€â”€ 201 â”€â”€â”€â”€â”€â”€â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚â—€â”€â”€ Order â”€â”€â”€â”‚              â”‚                â”‚              â”‚           â”‚
   â”‚             â”‚              â”‚                â”‚              â”‚           â”‚
```

**Steps**:

1. Customer envÃ­a POST /orders al API Gateway
2. Gateway valida JWT y routea a Order Service
3. Order Service reserva inventory (HTTP call)
4. Order Service cobra payment (HTTP call)
5. Order Service guarda order en database
6. Order Service publica evento "order.created" a RabbitMQ
7. Order Service retorna 201 Created
8. Notification Service (async) procesa evento y envÃ­a email

---

## ğŸ—ï¸ Deployment Diagram (Kubernetes)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AWS EKS Cluster (Kubernetes)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚           Ingress Controller (Kong)            â”‚     â”‚
â”‚  â”‚  - External Load Balancer (ELB)                â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                   â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚            Service Pods (Deployments)          â”‚     â”‚
â”‚  â”‚                                                â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚     â”‚
â”‚  â”‚  â”‚Order Podâ”‚  â”‚Order Podâ”‚  â”‚Order Podâ”‚       â”‚     â”‚
â”‚  â”‚  â”‚(Replica)â”‚  â”‚(Replica)â”‚  â”‚(Replica)â”‚       â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚     â”‚
â”‚  â”‚                                                â”‚     â”‚
â”‚  â”‚  [Similar for each microservice: 3 replicas]  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚         Stateful Services (StatefulSets)       â”‚     â”‚
â”‚  â”‚                                                â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚     â”‚
â”‚  â”‚  â”‚RabbitMQ 1â”‚  â”‚RabbitMQ 2â”‚  â”‚RabbitMQ 3â”‚    â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚     â”‚
â”‚  â”‚                                                â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚     â”‚
â”‚  â”‚  â”‚ Redis 1  â”‚  â”‚ Redis 2  â”‚  â”‚ Redis 3  â”‚    â”‚     â”‚
â”‚  â”‚  â”‚(Master)  â”‚  â”‚(Replica) â”‚  â”‚(Replica) â”‚    â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

External Managed Services:
â”œâ”€ RDS PostgreSQL (Multi-AZ)
â”œâ”€ MongoDB Atlas (Replica Set)
â””â”€ ElastiCache Redis (optional, for caching)
```

---

## ğŸ“– Notation Guide

### Person

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User   â”‚
â”‚(Person) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Software System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  E-Commerce     â”‚
â”‚ [Web System]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Container (Application/Service)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Order Service  â”‚
â”‚  [Node.js API]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Database

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Orders DB      â”‚
â”‚  [PostgreSQL]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Component

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OrderController    â”‚
â”‚  [Express Router]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— References

- [C4 Model Official Site](https://c4model.com/)
- [Structurizr (C4 Diagramming Tool)](https://structurizr.com/)
- [PlantUML for C4](https://github.com/plantuml-stdlib/C4-PlantUML)

---

**Ãšltima actualizaciÃ³n**: Diciembre 2025
